# Probabilistic Design Generator

## Prerequisites

You will need the [SBT](https://www.scala-sbt.org/download.html) tool to build and run the generator.

## Usage

In this directory, run:

```
./scripts/generate-uav2.sh DIR NUM
```

where DIR is output dir, and NUM is number of designs to generate.

The output dir will then contain a number of directories, each containing two files:
- `design_tree.json` describing the high-level design
- `design_swri.json` describing the low-level design, which can be executed via the simulation pipeline

If the output directories already contain `design_tree.json` files, the `design_swri.json` files
are generated from the pre-existing `design_tree.json` files. This allows us to go from high-level
inputs (perhaps generated by hand or using some other tool), to the low-level design format.

## Sequence-to-tree

From a `design_seq.json` file (e.g., produced by our transformer model), we can reconstruct a tree
(which can then be sent through the simulation pipeline), by running the command

```
./seq2tree-uav2.sh DIR [--rename]
```

where `DIR` contains a `design_tree.json` file. New files are generated by this command, as follows:
- If `--rename` is used, the files `design_tree_reconstructed.json` and `design_swri_reconstructed.json` are produced.
- Otherwise, `design_tree.json` and `design_swri.json` are produced

In either case, any existing files with the same names are overwritten.

Alternatively, `DIR` can be a super-directory containing subdirectories that in turn contain
`design_seq.json` files. In this case, the seq-to-tree converter runs on all the subdirectories.

## The Code

The most important files in this package are:
- `UAV2Design.scala`, containing classes that define the possible high-level design trees, as well as their translation into the low-level format.
- `DefaultUAV2Generator`, containing a probabilistic generator of design, which is easy to modify (or create a new one in a similar way, by extending `UAV2Generator`).
- `ComponentLibrary`, used to parse the `components_v2.json` file, which is used to check our designs against the actual content of the design DB.
